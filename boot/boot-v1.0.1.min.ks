{GLOBAL HUD_TOPLFT IS 1.GLOBAL HUD_TOPMID IS 2.GLOBAL HUD_TOPRGT IS 3.GLOBAL HUD_MID IS 4.GLOBAL HUD_STATUS IS 5.GLOBAL FUNCTION NotifyError {PARAMETER X,Y IS 5,Z IS TRUE. HUDTEXT("Error: "+X,Y,HUD_TOPMID,30,RED,Z).}GLOBAL FUNCTION NotifyInfo {PARAMETER X,Y IS 5,Z IS TRUE. HUDTEXT(X,Y,HUD_MID,24,CYAN,Z).}GLOBAL FUNCTION HasKSCConnection {IF ADDONS:AVAILABLE("RT") RETURN ADDONS:RT:HasKSCConnection(SHIP).ELSE RETURN HOMECONNECTION:ISCONNECTED.}FUNCTION F1 {IF CORE:TAG:LENGTH = 0 {LOCAL X IS SHIP:NAME. IF X:MatchesPattern("^[A-Z]+ - ") {LOCAL i IS X:Find("-")+2.SET X TO X:SubString(i,X:LENGTH-i).}SET CORE:PART:TAG TO X.}RETURN CORE:TAG.}FUNCTION F2 {LOCAL X IS F1().IF X:MatchesPattern("-[0-9]+[a-zA-Z]{0,1}$") SET X TO X:SubString(0,X:FindLast("-")).RETURN X.}FUNCTION F3 {return "0:/missions/"+F2()+"/"+F1()+".ks".}FUNCTION F4 {return "0:/missions/"+F2()+".ks".}FUNCTION F5 {RETURN "0:/KSC/"+F1()+".ks".}FUNCTION F6 {RETURN EXISTS(F5()).}FUNCTION F7 {PARAMETER X,Y.COPYPATH(X,Y).IF EXISTS(Y) {RUNPATH(Y).DELETEPATH(Y).RETURN TRUE.}NotifyError("Download Failed").RETURN FALSE.}FUNCTION F8 {LOCAL X IS F5().NotifyInfo("Receiving New Instructions from KSC...").WAIT 5.IF F7(X,"1:/update.ks") MOVEPATH(X,"0:/KSC/Archived/"+F1()+"/"+ROUND(TIME:SECONDS)+".ks").}FUNCTION F9 {PARAMETER X.NotifyInfo("Mission Start in T-10seconds...").WAIT 10.F7(X,"1:/mission.ks").}CLEARSCREEN. IF SHIP:STATUS = "PRELAUNCH" {IF NOT HasKSCConnection() {NotifyError("No Connection to KSC!").PRINT "Rebooting in 10 seconds...".WAIT 10.REBOOT.}IF F6() F8().IF EXISTS(F3()) F9(F3()).ELSE IF EXISTS(F4()) F9(F4()).}UNTIL 0 {IF HasKSCConnection() IF F6() {SET WARP TO 0.WAIT UNTIL KUNIVERSE:TIMEWARP:ISSETTLED. F8().}WAIT 10.}}